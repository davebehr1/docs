# Psql Basics

Psql is the terminal-based front end to PostgreSQL, and is the primary tool used
to communicate with your TimescaleDB instances. Below is a refresher on some essential
psql commands that you may come across in our documentation, and will find useful
as you explore PostgreSQL and TimescaleDB.

For an in-depth breakdown of all commands, visit [psql's documentation](https://www.postgresql.org/docs/13/app-psql.html).

## Connections

1. Connect to a PostgreSQL/TimescaleDB server via psql (using parameter flags)

   ```bash
   psql -h host_name -p port -U username -W -d database_name
   ```

2. Connect to a PostgreSQL/TimescaleDB server via psql (using a service URL)

   ```bash
   psql "your_service_URL"
   ```

3. Show your psql version
   ```bash
   psql --version
   ```

## Functions

1. Edit a function

   ```bash
   \ef function_name
   ```

2. Display all functions

   ```bash
   \df
   ```

3. Display all functions with more details (including owner, source code, and description)
   ```bash
   \df+
   ```

## Views

1. List views from current schema

   ```bash
   \dv
   ```

2. List views from all schemas
   ```bash
   \dv+
   ```

## Users

1. Display PostgreSQL database roles

   ```bash
   \du
   ```

2. Reset the password for a PostrgreSQL database user
   ```bash
   \password username
   ```

## Indexes and Extensions

1. List all indexes from all tables

   ```bash
   \di
   ```

2. Show all extensions installed
   ```bash
   \dx
   ```

## Import and Export CSV
The following commands can be used to import csv files and export csv files from 
your PostgreSQL or TimescaleDB database.

<terminal>

<tab label="Import">

```
\copy table_name FROM '/path/to/data.csv' DELIMITER ',' CSV HEADER
```

</tab>

<tab label="Export">

```
\copy (SELECT * FROM table_name) TO 'output_file.csv' WITH CSV HEADER

```

</tab>

</terminal>

## Backup and Restore

Note: the following commands utilize the pg_dump tool and pg_dumpall tools.

1. Create a backup for a specific database in plan-text SQL script file
   (with default backup options)

   ```
   pg_dump database_name > database_name.bak.sql
   ```

2. Creates a backup for a specific database in plan-text SQL script file
   (with customized backup options)

   ```
   pg_dump -c -C -F p -f database_name.bak.sql database_name
   ```

3. Run pg_dump on a client computer to back up data on a remote Postgres server

   ```
   pg_dump -h remote_host -p port -U user -f database_name.bak mydb
   ```

4. Backup all databases along with database roles and cluster-wide information

   ```
   pg_dumpall > alldb.bak.sql
   ```

5. Restore the database plain-text backup generated by pg_dump or pg_dumpall

   ```
   psql -U username -f filename.sql
   ```

6. Restore the database custom-archive backup (.bak)

   ```
   pg_restore -d database_name /path/to/your/file/database_name.bak -c -U database_user
   ```
